asyncapi: '2.6.0'

info:

  title: API чата в социальной сети для путешественников

  description: |
    Методы для real-time общения внутри чата социальной сети.

    Изначально аутентифицируем и авторизуем пользователя по HTTP обычными REST-запросами. Далее уже с полученным токеном делаем запросы по вебсокету, передавая его в cookie.

    Отображение доки можно глянуть тут https://studio.asyncapi.com/.

  version: '1.0.0'

servers:
  prod:
    url: localhost
    protocol: wss

channels:
  /chat/{id}:
    parameters:
      id:
        description: Идентификатор чата
        schema:
          type: string
      
    subscribe:
      security:
      - httpApiKey:
        - .

      summary: Отправить сообщение в чат

      operationId: subChatMessage

      message:

        $ref: '#/components/messages/chatMessage'

    publish:
      security:
      - httpApiKey:
        - .

      summary: Получить сообщение из чата

      operationId: pubChatMessage

      message:

        $ref: '#/components/messages/chatMessage'

components:
  securitySchemes:
    httpApiKey:
      type: httpApiKey
      name: api_key
      in: cookie
  messages:

    chatMessage:

      summary: Сообщение в чате

      payload:

        type: string
