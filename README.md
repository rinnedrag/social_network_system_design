# social_network_system_design
Развиваемся по курсу [System Design](https://balun.courses/courses/system_design). Проектируем свою социальную сеть для путешественников.

---

# Функциональные требования
- публикация поста с возможностью добавлять описание, прикреплять изображения и геолокацию
- возможность поставить "нравится" посту, а также снять эту отметку обратно
- добавление комментария под постом, а также удаление своих комментариев
- просмотр комментариев других пользователей. поддержка комментирования комментариев, а также лайков комментариев, не нужна.
- подписка на аккаунты других пользователей и отписка с них
- поиск постов по геолокации (с возможностью искать отдельно по стране или городу) и упорядоченный вывод по популярности (от постов с наибольшим количеством лайков к меньшим) по выбранной геолокации
- поддержка личных чатов между пользователями без отправки медиа-файлов
- отображение ленты с постами с аккаунтов, на которые подписан пользователь
- система аутентификации по номеру телефона с проверкой кода по смс
- отображение и редактирование профиля пользователя
- кросс-платформенная поддержка: веб и мобильное приложение
- GR (Govement Relations) 

# Нефункциональные требования
- DAU 10.000.000
- запускаем только в СНГ (поддержка только русского языка)
- шифрование переписок
- сезонность есть: будет пик в летние месяцы, праздники, новый год. люди будут больше делать постов о своих поездках.
- храним данные всегда
- соблюдаем доступность на уровне 99,99%
- время ответа - не больше 3 секунд
- в разрезе пользователя возьмём усреднённо:
  - публикация поста - 1 rpd, latency = 10 секунд
  - оценка и комментарии постов - 10 rpd, latency = 300 ms
  - новая подписка - 1 rpd, latency = 300 ms
  - поиск популярных мест - 10 rpd, latency = 3 секунды
  - общение в личке - 20 rpd, latency = 300 ms
  - просмотр ленты - 100 rpd, latency = 3 секунд
- ограничения по публикации поста:
  - максимальный размер загружаемого изображения - 3 МБ
  - максимальное количество фотографий в посте - 10
  - максимальный размер текста - 2000 символов
- ограничения по комментариям:
  - максимальное количество символов - 2000
- подписки:
  - максимальное количество подписок - 10000
- лента:
  - посты отдаются с пагинацией (бесконечная прокрутка)
- личные сообщения:
  - максимальное количество символов в сообщении - 2000

# Расчёт нагрузки

## RPS

**публикация поста**:
10.000.000 DAU * 1 rpd / 86400 sec per day = 115 rps
**оценка и комментарии постов**:
10.000.000 DAU * 10 rpd / 86400 sec per day = 1157 rps
**новая подписка**:
10.000.000 DAU * 1 rpd / 86400 sec per day = 115 rps
**поиск популярных мест**:
10.000.000 DAU * 10 rpd / 86400 sec per day = 1157 rps
**общение в личке**:
10.000.000 DAU * 20 rpd / 86400 sec per day = 115 rps
**просмотр ленты**:
10.000.000 DAU * 100 rpd / 86400 sec per day = 11574 rps

## Traffic

**публикация поста**:
Само текстовое сообщение будет занимать не более 4 КБ, а фотографии чаще всего весят до 1МБ в среднем. Фотографий за раз также в среднем выкладывают немного - 3 штуки.
Поэтому avg_req_size = 3 МБ
115 rps * 3 МБ = 50 GB/s
**оценка и комментарии постов**:
оценка практически ничего не весит, а вот комментарий может занимать до 4КБ данных.
1157 rps * 4 КБ = 4.6 МБ/с
**новая подписка/отписка**:
подписка/отписка не требует никаких дополнительных данных, кроме идентификатора подписки, с которым работаем. поэтому, условно, возьмём 400 байт (чтобы передать идентификатор и минимальные размеры служебных хедеров)
115 rps * 400 байт = 46 КБ/С
**поиск популярных мест с выводом постов**:
за раз подгружается 10 постов, у каждого поста отображается первая фотография (остальные в карусели). фотография в среднем занимает 1Мб. поэтому пользователь за запрос увидит 10 фотографий.
1157 rps * 10 МБ = 11.5 GB/s
**общение в личке**:
Само текстовое сообщение будет занимать не более 4 КБ.
115 rps * 4 Кб = 460 Кб/с
**просмотр ленты**:
за раз подгружается 10 постов, у каждого поста отображается первая фотография (остальные в карусели). фотография в среднем занимает 1Мб. поэтому пользователь за запрос увидит 10 фотографий.
11574 rps * 10 МБ = 115 GB/s

## Connections

Берём 10% от пользователей: 100.000 активных соединений.
